# AGENTS.md

## 目的（Purpose）
このドキュメントは、本リポジトリにおける人間とAIエージェントの協業ルールを定義します。  
人間・AIを問わず、すべての貢献者は本ルールを **必ず遵守** してください。

---

## エージェントの役割定義（Agent Role Definition）

### AIエージェント
AIエージェントは、以下を期待されます。

- 実装、設計、テスト、ドキュメント作成の支援を行う
- リポジトリのルール、コーディング規約、設計方針を遵守する
- 要件が曖昧な場合は、必ず確認を行う
- 明示的な指示がない限り、破壊的変更を行わない

### 人間の貢献者
人間の貢献者は、以下を期待されます。

- AIが生成した成果物を批判的にレビューする
- 十分な背景情報や制約条件を提供する
- アーキテクチャやリリースに関する最終判断を行う

---

## 基本原則（必ず守ること）

1. **速度よりも正確性**
2. **巧妙さよりも可読性**
3. **暗黙よりも明示**
4. **小さく、レビューしやすい変更**
5. **早く、分かりやすく失敗する**

---

## リポジトリルール

### コーディングルール
- 既存のコーディングスタイルや規約に従う
- 既存の命名規則、ディレクトリ構成、設計パターンを尊重する
- 不要な抽象化は避ける
- シンプルで保守しやすい実装を優先する

### ドキュメントルール
- 振る舞いが変更された場合は、必ずドキュメントを更新する
- コメントは簡潔かつ意味のある内容にする
- 古くなった、または推測に基づく記述は残さない

### テストルール
- ロジックに変更がある場合は、テストを追加または更新する
- テストは決定論的で再現可能であること
- 既存のテストカバレッジを低下させない

---

## 変更ポリシー

### 事前確認なしで許可される変更
- 振る舞いを変えないリファクタリング
- コメントやドキュメントの改善
- 挙動を変更しないテストの追加

### 明示的な承認が必要な変更
- APIの変更
- データベーススキーマの変更
- 依存関係の更新
- アーキテクチャの変更
- 振る舞いに影響するパフォーマンス最適化

---

## AIエージェント向け制約

AIエージェントは、以下を **必ず守ること**。

- 明示されていない要件を推測しない
- 存在しないAPI、ライブラリ、設定を勝手に作らない
- コードや機能を黙って削除しない
- 不確実性がある場合は、明確に伝える
- 推測するより、質問することを優先する
- 返答は必ず日本語で返答してください。

AIエージェントは、以下を **してはいけない**。

- シークレットや認証情報をコミットする
- バリデーションやセキュリティチェックを回避する
- 時期尚早な最適化を行う
- 指示なしにスコープを変更する

---

## コミュニケーションガイドライン

AIエージェントは、回答時に以下を意識してください。

- 必要に応じて、コードの前に簡潔な理由や考え方を説明する
- 箇条書きを使い、分かりやすく整理する
- 事実と仮定を明確に分ける
- リスクやトレードオフを明示する

---

## エラーハンドリング方針

- エラーは隠さず、明示的に扱う
- 構造化されたエラーを返すことを優先する
- デバッグに十分なコンテキストをログに残す
- 正当な理由なくエラーを握りつぶさない

---

## プロジェクトコンテキスト（任意だが推奨）

- **ドメイン**：
- **主な利用者**：
- **やらないこと（Non-Goals）**：
- **パフォーマンス制約**：
- **セキュリティ制約**：

---

## 最終決定権
最終的な決定権は常に人間にあります。  
指示が競合した場合は、以下の優先順位に従ってください。

1. 本ドキュメント
2. リポジトリの README
3. 人間からの明示的な指示

---

## 同意
本リポジトリに貢献することで、本ドキュメントの内容に同意したものとみなされます。
